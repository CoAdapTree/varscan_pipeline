




[![](https://img.shields.io/badge/CoAdapTree-UBC-green.svg?style=popout&logo=data:image/png;base64,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)](http://coadaptree.forestry.ubc.ca)
[![](https://img.shields.io/badge/python-3.7-blue.svg?style=popout&logo=data:image/png;base64,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)](https://www.python.org)
[![](https://img.shields.io/badge/GATK-3.8%20%7C%204.1.0.0-red.svg?style=popout&logo=data:image/png;base64,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)](https://software.broadinstitute.org/gatk/)
[![](https://img.shields.io/badge/Developed%20With-PyCharm-yellow.svg?style=popout&logo=data:image/png;base64,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)](https://www.jetbrains.com/pycharm/)

[![](https://img.shields.io/badge/VarScan-2.4.3-9cf.svg)](http://dkoboldt.github.io/varscan/using-varscan.html)

[![Codacy Badge](https://api.codacy.com/project/badge/Grade/559e9dd133a04f838a87582e79f0587b)](https://www.codacy.com/app/brandonlind/poolseq_pipline?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=CoAdaptree/poolseq_pipline&amp;utm_campaign=Badge_Grade)
[![codecov](https://codecov.io/gh/CoAdaptree/poolseq_pipeline/branch/master/graph/badge.svg)](https://codecov.io/gh/CoAdaptree/poolseq_pipeline)

# VarScan poolseq pipeline

Call SNPs and INDELs across pooled populations using VarScan. Filter (MAF, GQ, missing data) and redirect SNPs from repeat regions or potential paralogous sites into distinct files.

---
## Pipeline workflow

one

<div style="text-align:center"><img src="https://brandonlind.github.io/images/workflow.pdf" /></div>

two

<img src="./workflow.pdf" alt=""  width="4200" height="4200">

three

![text](./workflow.pdf)

four

![text](https://brandonlind.github.io/images/workflow.pdf)

five 

![workflow.pdf]()

six 

[text](brandonlind.github.io/images/workflow.pdf)

seven

[embed]brandonlind.github.io/images/workflow.pdf[/embed]

Command Specifics
- see docstrings at top of each .py file in repo for purpose, usage, assumptions, TODOs, etc.
- scroll each .py file to see bash text/replacements
- see example folder for example command.sh files output from the pipeline.
- 01_trim-fastq.py
    - Trim fastq files with fastp by iterating across windows of size 5 and asserting mean quality of 30; discard any reads that do not retain 75bp or have more than 20 N's. Attempt to remove adaptors if provided in datatable.txt
- 02_bwa-map_view-sort_index_flagstat.py
    - Add read groups, map with bwa-mem, filter reads that have mapping quality < 20 or are not proper pairs; discard query unmapped
- 03_mark_build.py
    - mark and remove duplicates with picardtools


## Assumed environment
1. Access to an HPC with a scheduler (e.g., slurm, SGE, PBS, TORQUE) - this pipeline assumes slurm with the Compute Canada servers in mind (not meant as a deployable 'program')
1. Ability to load the following modules via:
    1. `module load bwa/0.7.17`
    1. `module load fastp/0.19.5`
    1. `module load java`
    1. `module load samtools/1.9`
    1. `module load picard/2.18.9`
    1. `module load gatk/3.8` and `module load gatk/4.1.0.0`
    1. `module load bcftools/1.9`
1. Download and install VarScan (`VarScan.v2.4.3.jar`). The path to the jar executable will be exported in `bash_variables` below. Download VarScan from here: https://github.com/dkoboldt/varscan
1. In the `parentdir` folder that contains the fastq files, copy the following into a file called `bash_variables`. The `def-someuser` reflects your compute canada account that you would like to use to submit jobs. If you have multiple accounts available, the pipeline will balance load among them (you choose these accounts during 00_start execution). The following is needed to submit jobs before the pipeline balances load. See example file in GitHub repository.
    ```
    export SLURM_ACCOUNT=def-someuser
    export SBATCH_ACCOUNT=$SLURM_ACCOUNT
    export SALLOC_ACCOUNT=$SLURM_ACCOUNT
    export PYTHONPATH="${PYTHONPATH}:$HOME/pipeline"
    export SQUEUE_FORMAT="%.8i %.8u %.15a %.68j %.3t %16S %.10L %.5D %.4C %.6b %.7m %N (%r)"
    export VARSCAN_DIR=/project/def-yeaman/CoAdepTree/apps
    # placeholder for python environment activation (see below)
    ```
    1. The following is assumed regarding the name of slurm accounts found by `sshare -U --user $USER --format=Account`:
        1. The total character length of the account name is less than 15 - the full slurm account name will need to appear in the ACCOUNT column output from `squeue -u $USER` (using exported `SQUEUE_FORMAT` above); if not, increase the digits in `SQUEUE_FORMAT` from `%0.15a` to eg `%0.20a`.
        1. The characters in the account name that come before an underscore are sufficient to distinguish unique accounts - if the account name does not have an underscore then this is fine.
        1. The accounts that the user would like to use end in `_cpu` (as opposed to eg `_gpu`). The pipeline will skip over non-`_cpu` accounts.
1. Ability to install virtual environment with python 3.7 (e.g., `virtualenv --no-download ~/py3`)
    1. See example instructions here: https://docs.computecanada.ca/wiki/Python
    1. Add the appropriate activation command to the `bash_variables` file (eg `source ~/py3/bin/activate` for virutalenv)
1. The reference fasta file should be uncompressed (eg. ref.fa not ref.fa.gz), and the following commands should be executed before starting pipeline:
    1. `bwa index ref.fa`
    1. `samtools faidx ref.fa`
    1. `picard.jar CreateSequenceDictionary R=ref.fa O=ref.dict`
1. clone the pipeline repo's master branch to the server and create a symlink in `$HOME` so that it can be accessed via `$HOME/pipeline`


## Using the pipeline
- First create a python3 environment (see above).
    - then use the `requirements.txt` file in the repo to install the appropriate python dependencies.
        - `pip install -r $HOME/pipeline/requirements.txt`
- See example datatable.txt file needed for `00_start-pipeline.py`.
    - file names in `file_name_r1` and `file_name_r2` should be basenames not full paths
    - the entries in the `ref` column should be full paths
    - sample names in 'sample_name' column can be duplicates for samps sequenced multiple times
	- RG info, file paths, etc should of course be different between sequenced files of single samps
- Once the environment is set up, put `datatable.txt` and the fastq files (symlinks work too) into a folder. This is the folder I call `PARENTDIR`.

- To kick off the pipeline, source your bash_variables file in parentdir (source bash_variables) to activate the python env, export the pythonpath to the pipeline and other slurm variables. Then run `00_start-pipeline.py` from the login node, and it will run the rest of the preprocessing pipeline automatically by serially sbatching jobs up through SNP calling and filtering. If the user has chosed `pipeline-finish` as an email option, the pipeline will email the user once the pipeline is complete. If `fail` is chosen as an email option, the user will be emailed if any jobs die.

- Once the pipeline has finished you will get an email (assuming you choose the 'pipeline-finish' email notification) for each unique pool in the `pool_name` column of `datatable.txt`. Once all pools have finished, the next step is to run `98_get_read_stats.py` (see docstring at top of file for usage) to get summaries of read counts from pre-pipeline, through trimming, mapping, and realignment. Next, run `99_bundle_files_for_transfer.py` (see docstring at top of file for usage) to bundle all necessary files to transfer to a local server. This script will creat a .txt file with rsync commands that the user can execute from the remote server, and can also create md5 files for .bam and varscan output.

<div style="text-align:center"><img src="https://brandonlind.github.io/research/images/pipeline.png" /></div>

`(py3) [user@host ~]$ python $HOME/pipeline/00_start-pipeline.py -p PARENTDIR [-e EMAIL]
                            [-n EMAIL_OPTIONS [EMAIL_OPTIONS ...]] [-maf MAF]
                            [--translate] [--rm_repeats] [--rm_paralogs] [-h]`
```
required arguments:
  -p PARENTDIR          /path/to/directory/with/fastq.gz-files/

optional arguments:
  -e EMAIL              the email address you would like to have notifications
                        sent to
  -n EMAIL_OPTIONS [EMAIL_OPTIONS ...]
                        the type(s) of email notifications you would like to
                        receive from the pipeline. Requires --email-address.
                        These options are used to fill out the #SBATCH flags.
                        Must be one (or multiple) of
                        ['all', 'fail', 'begin', 'end', 'pipeline-finish']
                        (default: None)
  -maf MAF              At the end of the pipeline, VCF files will be filtered
                        for MAF. If the pipeline is run on a single
                        population/pool, the user can set MAF to 0.0 so as to
                        filter variants based on global allele frequency
                        across populations/pools at a later time. (if the
                        number of sample_names in a pool == 1 then default
                        maf=0; Otherwise maf = 1/sum(ploidy column)
  --translate           Boolean: true if used, false otherwise. If a stitched
                        genome is used for mapping, this option will look for
                        a ref.order file in the same directory as the
                        ref.fasta - where ref is the basename of the ref.fasta
                        (without the .fasta). The pipeline will use this
                        .order file to translate mapped positions to
                        unstitched positions at the end of the pipeline while
                        filtering. Positions in .order file are assumed to be
                        1-based indexing. Assumes .order file has no header,
                        and is of the format (contig name from unstitched
                        genome, start/stop are positions in the stitched genome):
                        ref_scaffold<tab>contig_name<tab>start_pos<tab>stop_pos<tab>contig_length
                        (default: False)
  --rm_repeats          Boolean: true if used, false otherwise. If repeat
                        regions are available, remove SNPs that fall within
                        these regions from final SNP table and write to
                        a REPEATS table. This option will look for a .txt file
                        in the same directory as the ref.fasta. Assumes the
                        filename is of the form: ref_repeats.txt - where ref
                        is the basename of the ref.fasta (without the .fasta).
                        This file should have 1-based indexing and should be
                        located in the same directory as the reference. The
                        file should have a header ('CHROM', 'start', 'stop').
                        The CHROM column can be names in the reference (if
                        using unstitched reference), or names of contigs that
                        were stitched to form the reference. If using a
                        stitched genome, --translate is required. (default:
                        False)
  --rm_paralogs         Boolean: true if used, false otherwise. If candidate
                        sites have been isolated within the reference where
                        distinct gene copies (paralogs) map to the same
                        position (and thus create erroneous SNPs), remove any
                        SNPs that fall on these exact sites and write to a
                        PARALOGS file. The pipeline assumes this file is
                        located in the parentdir, andends with
                        '_paralog_snps.txt'. This file is tab-delimited, and
                        must have a column called 'locus' thatcontains
                        hyphen-separated CHROM-POS sites for paralogs.
                        These sites should be found in the current ref.fa
                        being used to call SNPs (otherwise SNPs cannot be
                        filtered by these sites). (default: False)
  -h, --help            Show this help message and exit.

```


